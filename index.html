<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>üíò Para Jelly</title>
  <style>
    :root{
      --bg1:#090a14;
      --bg2:#1a0b2e;
      --card:#ffffff10;
      --stroke:#ffffff22;
      --text:#fff;
      --muted:#ffffffb8;
      --pink1:#ff4d8d;
      --pink2:#ff7ab3;
      --btn2:#ffffff14;
      --btn2Stroke:#ffffff2a;
    }
    *{box-sizing:border-box}
    body{
      margin:0; min-height:100svh; display:grid; place-items:center;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--text);
      background:
        radial-gradient(1200px 800px at 18% 12%, #ff4d8d2e, transparent 60%),
        radial-gradient(1200px 800px at 82% 20%, #7c3aed30, transparent 55%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      overflow:hidden;
    }

    /* Corazones flotando */
    .hearts{position:fixed; inset:0; pointer-events:none; opacity:.95; filter: drop-shadow(0 6px 12px #00000055);}
    .heart{
      position:absolute; width:12px; height:12px; transform: rotate(45deg);
      background: var(--pink1); border-radius: 3px; animation: floatUp linear infinite; opacity:.82;
    }
    .heart::before,.heart::after{content:""; position:absolute; width:12px; height:12px; background:inherit; border-radius:50%;}
    .heart::before{left:-6px; top:0}
    .heart::after{top:-6px; left:0}
    @keyframes floatUp{
      from{transform: translateY(20px) rotate(45deg); opacity:0}
      10%{opacity:.85}
      to{transform: translateY(-120vh) rotate(45deg); opacity:0}
    }

    .wrap{width:min(660px, 92vw); padding:18px;}
    .card{
      background: linear-gradient(180deg, #ffffff14, #ffffff0c);
      border:1px solid var(--stroke);
      border-radius:24px;
      padding:22px 18px 18px;
      backdrop-filter: blur(10px);
      box-shadow: 0 18px 60px #00000055;
      position:relative;
      overflow:hidden;
    }
    .badge{
      display:inline-flex; gap:10px; align-items:center;
      padding:8px 12px; border:1px solid var(--stroke);
      border-radius:999px; background:#ffffff0d;
      color:var(--muted); font-size:13px;
    }
    h1{
      margin:14px 0 8px;
      font-size: clamp(24px, 3.6vw, 38px);
      line-height:1.08;
      letter-spacing:.2px;
    }
    p{
      margin: 0 0 14px;
      color: var(--muted);
      line-height:1.55;
      font-size: 15.8px;
    }
    .type{
      min-height: 26px;
      font-weight:700;
      color:#fff;
      margin-bottom:10px;
    }
    .actions{
      margin-top:16px;
      display:flex; gap:12px; flex-wrap:wrap;
      justify-content:center;
      position:relative;
      padding: 8px 0 2px;
      min-height: 64px;
    }
    button{
      border:0; padding: 12px 16px;
      border-radius: 16px;
      font-weight: 800;
      cursor:pointer;
      transition: transform .12s ease, filter .12s ease, box-shadow .12s ease;
      user-select:none;
      min-width: 160px;
    }
    button:active{ transform: scale(.98); }
    .yes{
      background: linear-gradient(135deg, var(--pink1), var(--pink2));
      color:#fff;
      box-shadow: 0 12px 28px #ff4d8d40;
    }
    .yes:hover{ filter:brightness(1.05); transform: translateY(-1px); }
    .no{
      background: var(--btn2);
      border:1px solid var(--btn2Stroke);
      color:#fff;
      box-shadow: 0 10px 26px #0000002d;
      position:relative;
    }
    .no:hover{ transform: translateY(-1px); }
    .footer{
      margin-top:14px;
      display:flex; justify-content:space-between; gap:10px; flex-wrap:wrap;
      color:#ffffffa8;
      font-size:12.8px;
    }

    /* Overlay final */
    .overlay{
      position:fixed; inset:0; display:none; place-items:center;
      background: #050612cc; backdrop-filter: blur(8px);
      z-index: 10; padding: 18px;
    }
    .overlay.show{ display:grid; }
    .modal{
      width:min(720px, 94vw);
      border-radius:26px;
      background: linear-gradient(180deg, #ffffff18, #ffffff10);
      border:1px solid #ffffff22;
      box-shadow: 0 30px 90px #00000066;
      padding: 22px 18px 18px;
      position:relative; overflow:hidden;
    }
    .close{
      position:absolute; right:12px; top:12px;
      width:42px; min-width:auto; height:42px;
      border-radius:16px;
      background:#ffffff10;
      border:1px solid #ffffff20;
      color:#fff; font-size:18px; line-height:1;
    }
    .modal h2{
      margin: 10px 0 8px;
      font-size: clamp(22px, 3.4vw, 34px);
      line-height:1.1;
    }
    .modal p{ margin:0 0 14px; }
    .chips{ display:flex; flex-wrap:wrap; gap:8px; margin: 10px 0 2px;}
    .chip{
      font-size:13px; color:#fff;
      background:#ffffff14; border:1px solid #ffffff24;
      padding:8px 10px; border-radius:999px;
    }
    canvas#confetti{
      position:fixed; inset:0; pointer-events:none; z-index: 9;
    }
    .tiny{font-size:12.5px; color:#ffffff9a; margin-top:10px;}
  </style>
</head>
<body>
  <div class="hearts" id="hearts"></div>

  <div class="wrap">
    <main class="card" aria-live="polite">
      <div class="badge">üíå Para <b>Jelly</b> ¬∑ <span id="today"></span></div>

      <h1>Tengo una pregunta seria‚Ä¶</h1>
      <div class="type" id="typeLine"></div>

      <p id="subtext">
        No es una pregunta cualquiera. Es una de esas que se quedan contigo, porque la respuesta la quiero contigo.
      </p>

      <div class="actions" id="actions">
        <button class="yes" id="yesBtn">üíñ S√≠, acepto</button>
        <button class="no" id="noBtn">üôà No</button>
      </div>

      <div class="footer">
        <span>Hecho con ‚ù§Ô∏è para ti</span>
        <span>‚Äî AJ</span>
      </div>
    </main>
  </div>

  <canvas id="confetti"></canvas>

  <section class="overlay" id="overlay" role="dialog" aria-modal="true" aria-label="Respuesta">
    <div class="modal">
      <button class="close" id="closeBtn" aria-label="Cerrar">‚úï</button>
      <div class="badge">üéâ ¬°Dijo que s√≠!</div>

      <h2>Jelly‚Ä¶ me haces muy feliz üíò</h2>
      <p>
        Gracias por elegirnos. Prometo cuidarte, escucharte y seguir sumando detalles bonitos.
        ¬øTe parece si celebramos con una cita especial? üå∑
      </p>

      <div class="chips" id="chips"></div>

      <div class="actions" style="justify-content:flex-end; margin-top:12px;">
        <button class="yes" id="copyBtn">üìã Copiar mensajito</button>
      </div>

      <p class="tiny">Pista: hoy te toca elegir la primera actividad üòâ</p>
    </div>
  </section>

  <script>
    // Fecha bonita (Lima)
    const now = new Date();
    document.getElementById("today").textContent =
      now.toLocaleDateString("es-PE", { weekday:"long", year:"numeric", month:"long", day:"numeric" });

    // Texto ‚Äúm√°quina de escribir‚Äù
    const typeEl = document.getElementById("typeLine");
    const question = "¬øQuieres ser mi San Valent√≠n?";

    async function typeText(el, text, speed=34){
      el.textContent = "";
      for (let i=0; i<text.length; i++){
        el.textContent += text[i];
        await new Promise(r => setTimeout(r, speed));
      }
    }
    (async () => { await typeText(typeEl, question, 32); })();

    // Corazones flotando
    const hearts = document.getElementById("hearts");
    function spawnHeart(){
      const h = document.createElement("div");
      h.className = "heart";
      const left = Math.random() * 100;
      const size = 10 + Math.random() * 14;
      const dur = 6 + Math.random() * 6;
      h.style.left = left + "vw";
      h.style.bottom = (-10 - Math.random()*20) + "px";
      h.style.width = size + "px";
      h.style.height = size + "px";
      h.style.animationDuration = dur + "s";
      const hue = 330 + Math.random() * 25;
      h.style.background = `hsl(${hue} 100% 65%)`;
      hearts.appendChild(h);
      setTimeout(() => h.remove(), dur*1000);
    }
    setInterval(spawnHeart, 220);

    // Bot√≥n NO que se escapa
    const noBtn = document.getElementById("noBtn");
    const yesBtn = document.getElementById("yesBtn");
    const actions = document.getElementById("actions");

    const noPhrases = [
      "¬øSegura? ü•∫",
      "Pi√©nsalo bien‚Ä¶",
      "Jellyyyy üò≥",
      "Yo conf√≠o en ti üòå",
      "Ok‚Ä¶ √∫ltima vez üôà"
    ];
    let noCount = 0;

    function moveNoButton(){
      noCount++;
      const rect = actions.getBoundingClientRect();
      const btnRect = noBtn.getBoundingClientRect();
      const maxX = rect.width - btnRect.width;
      const maxY = 130;

      const x = Math.max(0, Math.random() * maxX);
      const y = Math.max(0, Math.random() * maxY);

      noBtn.style.position = "absolute";
      noBtn.style.left = x + "px";
      noBtn.style.top = y + "px";

      const phrase = noPhrases[Math.min(noCount-1, noPhrases.length-1)];
      noBtn.textContent = "üôà " + phrase;

      const scale = 1 + Math.min(noCount, 6) * 0.06;
      yesBtn.style.transform = `scale(${scale})`;
      yesBtn.style.boxShadow = `0 18px 40px #ff4d8d55`;
    }

    noBtn.addEventListener("mouseenter", moveNoButton);
    noBtn.addEventListener("touchstart", (e) => { e.preventDefault(); moveNoButton(); }, {passive:false});
    noBtn.addEventListener("click", moveNoButton);

    // Modal final + confetti
    const overlay = document.getElementById("overlay");
    const closeBtn = document.getElementById("closeBtn");
    const confettiCanvas = document.getElementById("confetti");
    const ctx = confettiCanvas.getContext("2d");

    function resizeCanvas(){
      confettiCanvas.width = window.innerWidth;
      confettiCanvas.height = window.innerHeight;
    }
    window.addEventListener("resize", resizeCanvas);
    resizeCanvas();

    // Chips (plan)
    const planChips = ["üçø Cine", "üçï Comida rica", "üå∑ Tulipanes", "üì∏ Fotos juntos", "üé∂ Playlist"];
    const chipsEl = document.getElementById("chips");
    for (const c of planChips){
      const span = document.createElement("span");
      span.className = "chip";
      span.textContent = c;
      chipsEl.appendChild(span);
    }

    let confetti = [];
    let confettiRunning = false;

    // polyfill roundRect
    if (!CanvasRenderingContext2D.prototype.roundRect) {
      CanvasRenderingContext2D.prototype.roundRect = function(x, y, w, h, r){
        const min = Math.min(w, h) / 2;
        r = Math.min(r, min);
        this.moveTo(x+r, y);
        this.arcTo(x+w, y, x+w, y+h, r);
        this.arcTo(x+w, y+h, x, y+h, r);
        this.arcTo(x, y+h, x, y, r);
        this.arcTo(x, y, x+w, y, r);
        this.closePath();
        return this;
      };
    }

    function startConfetti(){
      confetti = Array.from({length: 220}, () => ({
        x: Math.random()*confettiCanvas.width,
        y: -20 - Math.random()*confettiCanvas.height,
        r: 3 + Math.random()*4,
        vy: 2 + Math.random()*6,
        vx: -2 + Math.random()*4,
        rot: Math.random()*Math.PI,
        vr: -0.15 + Math.random()*0.3,
        hue: 320 + Math.random()*60
      }));
      confettiRunning = true;
      requestAnimationFrame(tickConfetti);
      setTimeout(() => confettiRunning = false, 5200);
    }

    function tickConfetti(){
      ctx.clearRect(0,0,confettiCanvas.width, confettiCanvas.height);
      for (const p of confetti){
        p.x += p.vx; p.y += p.vy; p.rot += p.vr;
        if (p.y > confettiCanvas.height + 30){
          p.y = -30; p.x = Math.random()*confettiCanvas.width;
        }
        ctx.save();
        ctx.translate(p.x, p.y);
        ctx.rotate(p.rot);
        ctx.beginPath();
        ctx.roundRect(-p.r, -p.r, p.r*2, p.r*2, 2);
        ctx.fillStyle = `hsl(${p.hue} 100% 65%)`;
        ctx.fill();
        ctx.restore();
      }
      if (confettiRunning) requestAnimationFrame(tickConfetti);
      else ctx.clearRect(0,0,confettiCanvas.width, confettiCanvas.height);
    }

    function openFinal(){
      overlay.classList.add("show");
      startConfetti();
    }
    function closeFinal(){
      overlay.classList.remove("show");
    }

    yesBtn.addEventListener("click", openFinal);
    closeBtn.addEventListener("click", closeFinal);
    overlay.addEventListener("click", (e) => { if (e.target === overlay) closeFinal(); });

    // Copiar mensaje (de AJ para Jelly)
    document.getElementById("copyBtn").addEventListener("click", async () => {
      const text =
`Jelly, ¬øquieres ser mi San Valent√≠n? üíò

Gracias por decir que s√≠. Prometo cuidarte, hacerte re√≠r y seguir construyendo lo nuestro con detalles bonitos.
¬øCelebramos con una cita especial? üå∑

‚Äî AJ`;
      try{
        await navigator.clipboard.writeText(text);
        const btn = document.getElementById("copyBtn");
        btn.textContent = "‚úÖ Copiado";
        setTimeout(()=> btn.textContent = "üìã Copiar mensajito", 1400);
      } catch {
        alert("No se pudo copiar autom√°tico. Puedes copiarlo manualmente üôÇ");
      }
    });
  </script>
</body>
</html>